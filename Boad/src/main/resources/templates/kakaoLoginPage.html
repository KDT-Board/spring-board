<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Kakao Login</title>
  <script>
    window.onload = function () {
      // 서버에서 전달받은 accessToken 가져오기
      const accessToken = '[[${accessToken}]]';
      if (accessToken) {
        // 세션 스토리지에 accessToken 저장
        sessionStorage.setItem("accessToken", accessToken);
        alert('로그인 성공!');
        window.location.href = '/view/user/main';
      }
      else {
        // 액세스 토큰이 없으면 카카오 로그인 API 호출
        window.location.href = document.getElementById('kakao-login-btn').getAttribute('href'); // 카카오 로그인 페이지로 리다이렉트
      }
    };
  </script>
</head>
<body>
<header>
  <nav style="background-color: green; padding: 10px;">
    <a href="/" th:href="@{/}" style="margin-right: 10px; color: black; text-decoration: none;">Home</a>
    <a href="/view/user/join" th:href="@{/view/user/join}" style="margin-right: 10px; color: black; text-decoration: none;">가입인사</a>
    <a href="/view/board/free" th:href="@{/view/board/free}" style="margin-right: 10px; color: black; text-decoration: none;">자유게시판</a>
    <a href="/view/board/gold" th:href="@{/view/board/gold}" style="margin-right: 10px; color: black; text-decoration: none;">골드게시판</a>
    <a href="/view/user/join" th:href="@{/view/user/join}" style="margin-right: 10px; color: black; text-decoration: none;">회원가입</a>
    <a href="/view/user/login" th:href="@{/view/user/login}" style="margin-right: 10px; color: black; text-decoration: none;">로그인</a>
  </nav>
</header>
<div class="text-center">
  <!-- "카카오 로그인 중입니다." 메시지 -->
  <p id="loading-message">카카오 로그인 중입니다...</p>
  <!-- 카카오 로그인 버튼 -->
  <a id="kakao-login-btn" href="https://kauth.kakao.com/oauth/authorize"
     th:href="@{https://kauth.kakao.com/oauth/authorize(client_id=${clientId}, redirect_uri=${redirectUrl}, response_type='code')}">
  </a>
</div>
</body>
</html>